# üì¶ KhrllwTest API

RESTful API –Ω–∞ Go (Gin) —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, PostgreSQL –∏ Docker. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –±–∞–∑–æ–≤–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è,
—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∑–∞–∫–∞–∑–∞–º–∏.

---

## üìå –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏](#-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏)
- [üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏](#-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏)
- [‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
- [üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–æ–±—Ä–∞–±–æ—Ç–∫–∏)
- [üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ](#-—Ç–µ—Å—Ç–æ–≤–æ–µ-–ø–æ–∫—Ä—ã—Ç–∏–µ)

---

## üåü –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Handlers, Services, Repositories)

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–Ø–∑—ã–∫**: Go 1.20+
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: Gin
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL
- **ORM**: GORM
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Swagger (Swag)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ö–∞—Å—Ç–æ–º–Ω—ã–π –ª–æ–≥–≥–µ—Ä —Å —Ü–≤–µ—Ç–∞–º–∏
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Docker Compose

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–µ–∫—Ç–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

1. **Go (–≤–µ—Ä—Å–∏–∏ 1.20 –∏ –≤—ã—à–µ)**</br>
   –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Go —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞:
   [Go 1.20+](https://go.dev/dl/)

2. **Docker –∏ Docker Compose**</br>
   –î–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker –∏ Docker Compose. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞
   –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–º —Å–∞–π—Ç–µ:
   [Docker –∏ Compose](https://docs.docker.com/compose/install/)

3. **Swag CLI (–¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Swagger)**</br>
   –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Swagger, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Swag CLI:

   ```bash
   go install github.com/swaggo/swag/cmd/swag@latest
   ```

   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ Swag CLI –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ GitHub:
   [Swaggo GitHub](https://github.com/swaggo/swag)

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –ª–æ–∫–∞–ª—å–Ω–æ, —Å–ª–µ–¥—É–π—Ç–µ —ç—Ç–∏–º —à–∞–≥–∞–º:

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
   
   –°–Ω–∞—á–∞–ª–∞ –∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ –≤–∞—à—É –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É:

   ```bash
   git clone https://github.com/Khrllw/kvant_tz.git
   ```

   –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ —Å –ø—Ä–æ–µ–∫—Ç–æ–º:

   ```bash
   cd kvant_tz
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª .env**

   –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —É–∫–∞–∑–∞–Ω–æ [–∑–¥–µ—Å—å](#-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-–æ–∫—Ä—É–∂–µ–Ω–∏—è)


3. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
   –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ API –≤ —Ñ–æ—Ä–º–∞—Ç–µ Swagger, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

   ```bash
   swag init -g cmd/main.go
   ```

   –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ API –≤ –ø—Ä–æ–µ–∫—Ç–µ.

4. **–°–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç**
   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Compose –¥–ª—è —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:

   ```bash
   docker compose up --build
   ```

   –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:

   * –°–æ–±–µ—Ä–µ—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ `docker-compose.yml`
   * –ó–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ–µ–∫—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö Docker

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –∫–æ–º–∞–Ω–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8080` (–∏–ª–∏ –¥—Ä—É–≥–æ–º—É,
–ø–æ—Ä—Ç—É —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `.env` —Ñ–∞–π–ª –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Docker:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è       | –û–ø–∏—Å–∞–Ω–∏–µ                | –ü—Ä–∏–º–µ—Ä           |
|------------------|-------------------------|------------------|
| `JWT_KEY`        | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è JWT  | `supersecretkey` |
| `JWT_EXPIRATION` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞      | `24h`            |
| `DB_HOST`        | –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö        | `db`             |
| `DB_PORT`        | –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö        | `5432`           |
| `DB_USER`        | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL | `postgres_adm`   |
| `DB_PASSWORD`    | –ü–∞—Ä–æ–ª—å PostgreSQL       | `password`       |
| `DB_NAME`        | –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö    | `khrllw_test`    |

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project/
‚îú‚îÄ‚îÄ cmd/                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (main.go)
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/          # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ handlers/          # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ models/            # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (GORM)
‚îÇ   ‚îú‚îÄ‚îÄ repository/        # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ middleware/        # JWT, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ utils/             # –•–µ–ª–ø–µ—Ä—ã (—Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–æ–∫–µ–Ω—ã)
‚îÇ   ‚îî‚îÄ‚îÄ migrations/        # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docs/                  # Swagger
‚îú‚îÄ‚îÄ .env                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ tests                  # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ Dockerfile             # –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ docker-compose.yml     # Compose-—Ñ–∞–π–ª
‚îú‚îÄ‚îÄ go.mod/go.sum          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîÑ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏

       1. –ó–∞–ø—Ä–æ—Å –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
       2. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä Gin
       3. –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û (–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è / –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
       4. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (UserHandler / OrderHandler)
       5. –°–µ—Ä–≤–∏—Å—ã (UserService / OrderService)
       6. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (UserRepository / OrderRepository)
       7. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

*–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –∑–∞–ø—É—Å–∫—É —Ç–µ—Å—Ç–æ–≤, –µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ*

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É `tests`.
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—Ç—Å—è –Ω–∞ `_test`, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–∞–Ω–¥—É Go:

```bash
  go test ./tests/*_test.go
```

---

## ‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

### üõ°Ô∏è JWT

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**

* `Test1_ValidJWTLogin`
* `Test2_LoginWithWrongPassword`
* `Test3_LoginWithUnknownEmail`

**–ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã**

* `Test4_RequestWithoutToken`
* `Test5_RequestWithInvalidTokenFormat`
* `Test9_MissingBearerPrefix`
* `Test12_ValidTokenAccess`

**–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã**

* `Test6_RequestWithTamperedToken`
* `Test7_ExpiredTokenSimulation`
* `Test8_UseTokenOfAnotherUser`
* `Test10_TokenReuseAfterUserDeletion`
* `Test11_MalformedJWTStructure`
* `Test13_TokenWithFutureIat`
* `Test14_TokenWithNoneAlg`
* `Test15_TokenWithInvalidSignature`
* `Test16_TokenInBodyInsteadOfHeader`
* `Test18_TokenWithExtraClaims`
* `Test19_TokenReuseMultipleTimes`

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

**–°–æ–∑–¥–∞–Ω–∏–µ**

* `TestUser1_CreateValidUser`
* `TestUser2_CreateDuplicateUser`
* `TestUser9_CreateUserWithEmptyName`
* `TestUser10_CreateUserWithInvalidAge`

**–ü–æ–ª—É—á–µ–Ω–∏–µ**

* `TestUser3_GetUserByID`
* `TestUser6_GetUsersList`
* `TestUser7_GetUsersWithPagination`

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**

* `TestUser4_UpdateUserName`
* `TestUser8_UpdateUserInvalidEmail`
* `TestUser13_UpdateOtherUser`

**–£–¥–∞–ª–µ–Ω–∏–µ**

* `TestUser5_DeleteUser`
* `TestUser14_DeleteOtherUser`

### üì¶ –ó–∞–∫–∞–∑—ã

**–°–æ–∑–¥–∞–Ω–∏–µ**

* `TestOrder1_CreateOrder`
* `TestOrder6_CreateOrderWithoutAuth`
* `TestOrder10_CreateOrderWithInvalidPayload`

**–ü–æ–ª—É—á–µ–Ω–∏–µ**

* `TestOrder2_ListOrders`
* `TestOrder3_GetSingleOrderByID`
* `TestOrder7_GetOtherUsersOrder`

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**

* `TestOrder4_UpdateOrder`
* `TestOrder8_UpdateOrderNotOwned`

---

